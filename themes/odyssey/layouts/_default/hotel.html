{{- define "template" }}
{{- if ne (getenv "HUGO_ENV") "production" -}}

{{- partial "show-template" (dict "Which" .Kind "Template" "layouts/_default/hotel.html") -}}

{{- end }}
{{- end }}

{{- define "main" }}
{{"<!-- display city -->" | safeHTML}}
{{- $id    := cond (isset .Params "id") .Params.id .CurrentSection.Params.translationKey }}
{{- $image := cond (isset .Params "image") ( .Params.image ) (.CurrentSection.Params.image) }}

<section id="{{ $id | lower }}"> 
   <div class="hero hero-image" style="background-image: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.5)), url('{{.Permalink }}{{ range $index, $e := .Params.carousel }}{{ if eq $index 0 }}{{ $e.url }}{{ end }}{{ end }}');" >
  </div>
  <div class="container">
    <div class="row">
      <div class="content mx-auto w-50 p-3">
        <h2>{{ .Title }}</h2>
          {{- with .Params.subtitle }}<h3>{{ . }}</h3>{{ end }}
        {{ .Content }}
      </div>
    </div>
  </div>

  {{ "<!-- image carousel --> " | safeHTML }}
  <div id="carousel" class="carousel slide multi-item-carousel" data-ride="carousel">
    <ol class="carousel-indicators">
      {{- range $index, $e := $.Page.Params.carousel }}
      <li data-target="#carousel" data-slide-to="{{ $index }}" {{ if eq $index 0 }} class="active" {{ end }}></li>
      {{- end }}
    </ol>
    <div class="carousel-inner">
      {{- range $index, $e := $.Page.Params.carousel }}
      {{- $src := $.Page.Resources.GetMatch ( printf "*%s*" ($e.url)) }}
      {{- if $src }}

      {{- $tinyw   := default "500x" }}
      {{- $smallw  := default "800x" }}
      {{- $mediumw := default "1200x" }}
      {{- $largew  := default "1500x" }}

      {{- $.Scratch.Set "tiny"   ($src.Resize $tinyw) }}
      {{- $.Scratch.Set "small"  ($src.Resize $smallw) }}
      {{- $.Scratch.Set "medium" ($src.Resize $mediumw) }}
      {{- $.Scratch.Set "large"  ($src.Resize $largew) }}

      {{- $tiny   := $.Scratch.Get "tiny" }}
      {{- $small  := $.Scratch.Get "small" }}
      {{- $medium := $.Scratch.Get "medium" }}
      {{- $large  := $.Scratch.Get "large" }}
      <div class="carousel-item {{ if eq $index 0 }} active {{ end }}">
        <div class="item__third">
          <img class="lazyload d-block w-100" sizes="(min-width: 35em) 1200px, 100vw" data-srcset="
          {{ with $tiny.RelPermalink }} {{.}} 500w{{ end }}
          {{ with $small.RelPermalink }},{{.}} 800w{{ end }}
          {{ with $medium.RelPermalink }},{{.}} 1200w{{ end }}
          {{ with $large.RelPermalink }},{{.}} 1500w{{ end }}"
          data-src="{{- $src.RelPermalink -}}" alt="{{ (index . "title") }}" >
          <!--
          <div class="carousel-caption d-none d-md-block">
            <h5>First slide label</h5>
          </div> 
          -->
        </div>
      </div>
      {{- end }}
      {{- end }}
    </div>
      <a class="carousel-control-prev" href="#carousel" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true">
        </span>
        <span class="sr-only">Previous</span>
      </a>
      <a class="carousel-control-next" href="#carousel" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true">
        </span>
        <span class="sr-only">Next</span>
      </a>
    </div>
  {{ "<!-- end image carousel --> " | safeHTML }}

  {{ "<!-- mobile image carousel --> " | safeHTML }}
  
  <div id="mobile-carousel" class="carousel slide carousel-fade" data-ride="carousel">
    <ol class="carousel-indicators">
    {{- range $index, $e := $.Page.Params.carousel }}
      <li data-target="#mobile-carousel" data-slide-to="{{ $index }}" {{ if eq $index 0 }}class="active"{{ end }}></li>{{- end }}
    </ol>
    <div class="carousel-inner">
      {{- range $index, $e := $.Page.Params.carousel }}
      {{- $src := $.Page.Resources.GetMatch ( printf "*%s*" ($e.url)) }}
      {{- if $src }}

      {{- $tinyw   := default "500x" }}
      {{- $smallw  := default "800x" }}
      {{- $mediumw := default "1200x" }}
      {{- $largew  := default "1500x" }}

      {{- $.Scratch.Set "tiny"   ($src.Resize $tinyw) }}
      {{- $.Scratch.Set "small"  ($src.Resize $smallw) }}
      {{- $.Scratch.Set "medium" ($src.Resize $mediumw) }}
      {{- $.Scratch.Set "large"  ($src.Resize $largew) }}

      {{- $tiny   := $.Scratch.Get "tiny" }}
      {{- $small  := $.Scratch.Get "small" }}
      {{- $medium := $.Scratch.Get "medium" }}
      {{- $large  := $.Scratch.Get "large" }}

      <div class="carousel-item {{ if eq $index 0 }} active {{ end }}">
        <img class="lazyload" sizes="(min-width: 35em) 1200px, 100vw" data-srcset="
          {{ with $tiny.RelPermalink }} {{.}} 500w{{ end }}
          {{ with $small.RelPermalink }},{{.}} 800w{{ end }}
          {{ with $medium.RelPermalink }},{{.}} 1200w{{ end }}
          {{ with $large.RelPermalink }},{{.}} 1500w{{ end }}"
          data-src="{{- $src.RelPermalink -}}" alt="{{ (index . "title") }}" >
        <div class="carousel-caption  d-none d-md-block">
          <h5>
            <span class="carousel-overlay">{{ (index . "title") }}</span>
          </h5>
          <p> </p>
        </div>
      </div> 
      {{- end }}
      {{- end }} 
      <a class="carousel-control-prev" href="#mobile-carousel" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true">
        </span>
        <span class="sr-only">Previous</span>
      </a>
      <a class="carousel-control-next" href="#mobile-carousel" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true">
        </span>
        <span class="sr-only">Next</span>
      </a>
    </div>
  </div>
  {{ "<!-- end of carousel --> " | safeHTML }}

</section>
{{"<!-- end Content -->" | safeHTML}}
{{- end }}
