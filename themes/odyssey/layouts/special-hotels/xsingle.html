{{- define "template" }}
{{- if ne (getenv "HUGO_ENV") "production" -}}

{{- partial "show-template" (dict "Which" .Kind "Template" "layouts/special-hotels/single.html") -}}

{{- end }}
{{- end }}

{{- define "main" }}

{{- $id := cond (isset .Params "id") .Params.id .CurrentSection.Params.translationKey }}

{{- $hotels := sort (where (where .Site.Pages "Section" "states") ".Params.id" "hotel") ".Params.rating" "desc" }}

<section id="{{ $id | lower }}"> 
  	{{ partial "heading.html" . }}
  	<div class="container">
    	<div class="row">
      		<div class="mx-auto w-50 p-3">
        	{{ with .Params.subtitle }}<h3>{{ . }}</h3>{{ end }}
        	{{ .Content }}
      		</div>
    	</div>
  	</div>

  	<!--
  <div class="container">
    <div class="row">
      <div class="topbar">Filters</div>
    </div>
  </div>   
	-->
    <div id="main">
       	<div class="row">
       		<div class="col-sm-4 col-md-3 ">
  				<div class="filter">

				    <div class="box">
				      <span id="counter"> <i class="icon-info-circled"></i> {{ len $hotels }} hotels found</span>
				      <div id="showAll"> 
				        <a href="#">&nbsp;</a>
				      </div>
				    </div>

					<div class="box">
				        <form class="form-inline">
				          	<div class="form-group">
				              	<label for="city">Filter by Place</label>
				              	<div class="input-group">  
					                <select onChange="cityFunction(this)" name="city" class="dropdown">
{{- $cities := slice }}
{{- range $i,$e := sort (where (where .Site.Pages "Section" "states") ".Params.id" "hotel") ".Title" "desc" }}  
  {{- $data := printf "%s@%s" (urls.Parse $e.CurrentSection.Parent.Permalink).Path   $e.CurrentSection.Parent.Title }} 
  {{- $cities = $cities | append $data }}
{{- end }}
					                	{{- range $cities | uniq }}  
					                	{{- $data := (split . "@" ) }}
					                	<option value="{{ index $data 0 | relURL}}">{{ index $data 1 }}</option>
					                	{{- end }}
					                </select>
				              	</div>
				            </div>
				        </form>
				    </div>

				    <div class="box">
				      <div class="sliderRating">
				        <label for="price-range">Rating</label><br> 
				        <div class="flex-range">
				          <div>1</div>
				          <div>5</div>
				        </div>
				        <input type="range" class="range" min="1" max="5" step="1" id="price-range" value="5" >
				        <output class="bubble"></output>
				      </div>
				    </div>
   
				    <div class="box">
				        <form class="form-inline">
				          <div class="form-group">
				              <label for="search">Search</label>
				              <div class="input-group mb-2">  
				                <input type="text" class="form-control" id="search" placeholder="Search">
				                <div class="input-group-prepend">
				                  <div class="input-group-text"><i class="icon-search"></i></div>
				                </div>
				              </div>
				          </div>
				        </form>
				    </div>

				</div>
		    </div>
		    <div class="col-sm-8 col-md-9">
          	{{"<!-- show the items -->" | safeHTML}}
            <div class="card-deck">
              	<div class="row row-cols-1 row-cols-md-4">
                	{{ range $hotels }}    
	               	<div class="card-spacing">
	                  	<div class="card h-100" dataRating={{ with .Params.rating }}"{{ . }}"{{ else }}"0"{{ end }} city="{{ .CurrentSection.Parent.Title }}" >
		                    <div class="card-header img-top">
										{{- with .Resources.ByType "image" }}  	
				                      	{{- range $index,$img := . }}
				                      	{{- if eq $index 0}}
				                        <img class="mr-3 lazyload" itermprop="image" data-src="{{ $img.RelPermalink }}" alt="{{ $img.Title }}">
				                      	{{- end }}
				                      	{{- end }}
				                    	{{- end }}
								{{- with .Params.rating }}
								<p class="dollars">{{ "$" | strings.Repeat . }}</p>
								{{- end }}
		                    </div>    
		                    <div class="card-body">
		                      	<h3 class="card-title">
		                        	<a href="{{ .Permalink }}">{{ .Title }}</a>
		                      	</h3>     
		                      	<h4><a href="{{ .CurrentSection.Parent.Permalink }}" >{{ .CurrentSection.Parent.Title }}</a></h4> 
		                    </div>
	                  	</div>
	                </div>          
                	{{- end }}
              	</div>
        	</div>
        	{{"<!-- end of the items -->" | safeHTML}}
        </div>
    </div>
</section>

{{- end }}